(()=>{"use strict";class t{static addTextElement(t,e){const n=document.createElement("div");n.classList.add("content-item"),e.appendChild(n);const i=document.createElement("div");i.textContent=t,i.classList.add("content-item-text"),n.appendChild(i);const o=document.createElement("div");o.innerHTML="&#x2718",o.classList.add("content-item-del"),o.classList.add("content-item-del-hide"),n.appendChild(o)}static addEmptyElement(t,e){const n=document.createElement("div");n.classList.add("empty-item");const i=t.getBoundingClientRect();if(n.style.height=i.height+"px",e.classList.contains("content-item"))e.parentElement.insertBefore(n,e);else{const t=e.querySelector(".column-content");t&&t.appendChild(n)}return n}}class e{static save(){document.querySelectorAll(".column").forEach((t=>{const e=t.querySelectorAll(".content-item-text"),n=[];for(const t of e)n.push(t.textContent);"todo"===t.id?localStorage.setItem("todo",JSON.stringify(n)):"inProgress"===t.id?localStorage.setItem("inProgress",JSON.stringify(n)):"done"===t.id&&localStorage.setItem("done",JSON.stringify(n))}))}static load(e){["todo","inProgress","done"].forEach((e=>{null!==localStorage.getItem(e)&&JSON.parse(localStorage.getItem(e)).forEach((n=>{const i=document.getElementById(e).querySelector(".column-content");t.addTextElement(n,i)}))}))}}new class{constructor(){this.addCard=document.querySelectorAll(".add-card"),this.addCardClick=this.addCardClick.bind(this),this.addCardClick(),this.buttonAdd=document.querySelectorAll(".button-add-card"),this.buttonAddClick=this.buttonAddClick.bind(this),this.buttonAddClick(),this.buttonCancel=document.querySelectorAll(".button-cancel"),this.buttonCancelClick=this.buttonCancelClick.bind(this),this.buttonCancelClick(),this.container=document.querySelector(".container"),this.containerMouseOver=this.containerMouseOver.bind(this),this.containerMouseOver(),this.containerMouseOut=this.containerMouseOut.bind(this),this.containerMouseOut(),this.containerMouseDown=this.containerMouseDown.bind(this),this.containerMouseDown(),this.containerMouseMove=this.containerMouseMove.bind(this),this.containerMouseMove(),this.containerMouseDownFunction=this.containerMouseDownFunction.bind(this),this.containerMouseOutFunction=this.containerMouseOutFunction.bind(this),this.containerMouseOverFunction=this.containerMouseOverFunction.bind(this),this.containerMouseUpFunction=this.containerMouseUpFunction.bind(this),this.containerMouseUp=this.containerMouseUp.bind(this),this.containerMouseUp(),e.load(this),this.targetElement=null}addCardClick(){this.addCard.forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault(),this.showHideAddForm(t.target)}))}))}showHideAddForm(t){console.log("Смена видимости");const e=t.closest(".column");e.querySelector(".add-card").classList.toggle("add-card-hidden"),e.querySelector(".fill-form").classList.toggle("fill-form-hidden")}buttonAddClick(){this.buttonAdd.forEach((n=>{n.addEventListener("click",(n=>{n.preventDefault(),console.log("Добавление элемента");const i=n.target.closest(".column").querySelector(".column-content"),o=n.target.closest(".fill-form").querySelector(".fill-card-textarea").value;t.addTextElement(o,i),n.target.closest(".fill-form").querySelector(".fill-card-textarea").value="",this.showHideAddForm(n.target),e.save()}))}))}buttonCancelClick(){this.buttonCancel.forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault(),t.target.closest(".fill-form").querySelector(".fill-card-textarea").value="",this.showHideAddForm(t.target)}))}))}containerMouseOver(){this.container.addEventListener("mouseover",this.containerMouseOverFunction.bind(this))}containerMouseOverFunction(t){const n=t.target.closest(".content-item");if(n){const t=n.querySelector(".content-item-del");t.classList.contains("content-item-del-hide")&&t.classList.remove("content-item-del-hide"),t.addEventListener("click",(t=>{t.preventDefault(),n.remove(),e.save()}))}}containerMouseOut(){this.container.addEventListener("mouseout",this.containerMouseOutFunction.bind(this))}containerMouseOutFunction(t){let e=t.target.closest(".content-item");null!=e&&e.querySelector(".content-item-del").classList.add("content-item-del-hide"),null!=this.actualElement&&null!=this.targetElement&&t.relatedTarget&&t.relatedTarget!=this.targetElement&&(this.targetElement.remove(),this.targetElement=null)}containerMouseDown(){let t=this.containerMouseDownFunction.bind(this);this.container.addEventListener("mousedown",t)}containerMouseDownFunction(t){if(null==this.actualElement&&(t.target.classList.contains("content-item")||t.target.classList.contains("content-item-text"))){const e=t.target.closest(".content-item");t.preventDefault(),this.actualElement=e;const n=e.getBoundingClientRect();this.actualElement.style.width=n.width-16+"px",this.actualElement.style.height=n.height-16+"px",this.difX=t.clientX-n.x,this.difY=t.clientY-n.y,this.actualElement.classList.add("dragged"),document.body.style.cursor="grabbing"}}containerMouseMove(){let t=this.containerMouseMoveFunction.bind(this);this.container.addEventListener("mousemove",t)}containerMouseMoveFunction(e){null!=this.actualElement&&(this.actualElement.style.top=e.clientY-this.difY+"px",this.actualElement.style.left=e.clientX-this.difX+"px");const n=e.target.closest(".content-item");if(null!=this.actualElement&&null===this.targetElement&&null!=e.target)if(null===n){const n=e.target.closest(".column-header");let i=null;if(n&&(i=n.nextElementSibling.querySelector(".content-item")),i)this.targetElement=t.addEmptyElement(this.actualElement,i);else{const n=e.target.closest(".column");n&&(this.targetElement=t.addEmptyElement(this.actualElement,n))}}else this.targetElement=t.addEmptyElement(this.actualElement,n)}containerMouseUp(){let t=this.containerMouseUpFunction.bind(this);this.container.addEventListener("mouseup",t)}containerMouseUpFunction(t){if(void 0===this.actualElement)return;const n=t.target.closest(".column");if(null!=n){const i=n.querySelector(".column-content"),o=t.target.closest(".content-item"),s=t.target.closest(".empty-item");if(s)i.insertBefore(this.actualElement,s);else if(o)i.insertBefore(this.actualElement,o);else{const e=t.target.closest(".column-header");let n=null;e&&(n=e.nextElementSibling.querySelector(".content-item")),n?i.insertBefore(this.actualElement,n):i.appendChild(this.actualElement)}this.actualElement.classList.remove("dragged"),this.actualElement.style.width="",this.actualElement.style.height="",this.actualElement=void 0,document.body.style.cursor="auto",null!=this.targetElement&&(this.targetElement.remove(),this.targetElement=null),e.save()}else this.actualElement.classList.remove("dragged"),document.body.style.cursor="auto",this.actualElement=void 0}}})();
//# sourceMappingURL=main.js.map